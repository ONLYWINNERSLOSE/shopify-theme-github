<div
  class="product-badges product-badges--{{ settings.badge_position }}"
  style="
    --badge-border-radius: {{ settings.badge_corner_radius }}px;

    --badge-font-family: var(--font-{{ settings.badge_font_family }}--family);
    --badge-font-weight: var(--font-{{ settings.badge_font_family }}--weight);
    --badge-text-transform: {{ settings.badge_text_transform }};

    --badge-font-size: {{ settings.badge_font_size }}px;
    --badge-font-size-mobile: {{ settings.badge_font_size_mobile }}px;

    --badge-state-font-size: {{ settings.badge_state_font_size }}px;
    --badge-state-font-size-mobile: {{ settings.badge_state_font_size_mobile }}px;

    --badge-gap-mobile: {{ settings.badge_gap_mobile }}px;
  "
>
  {%- assign main_badge = '' -%}
  {%- assign state_badge = '' -%}

  {%- comment -%} Badge principal (en haut) {%- endcomment -%}
  {%- if product.tags contains 'soon' -%}
    {%- capture main_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-soon">Soon</div>
      <!-- DEBUG badge_font_size: {{ settings.badge_font_size }} / mobile: {{ settings.badge_font_size_mobile }} -->

    {%- endcapture -%}
  {%- elsif product.tags contains 'archive' -%}
    {%- capture main_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-archive">Archivé</div>
    {%- endcapture -%}
  {%- elsif product.tags contains 'owl_studio' -%}
    {%- capture main_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-studio">Studio</div>
    {%- endcapture -%}
  {%- elsif product.tags contains 'owl_made' -%}
    {%- capture main_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-made">Made</div>
    {%- endcapture -%}
  {%- elsif product.tags contains 'owl_creative' -%}
    {%- capture main_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-creative">Creative</div>
    {%- endcapture -%}
  {%- elsif product.tags contains 'preorder' -%}
    {%- capture main_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-preorder">Précommande</div>
    {%- endcapture -%}
  {%- endif -%}

  {%- comment -%} Badge état produit (en dessous) {%- endcomment -%}
  {%- if product.available == false -%}
    {%- capture state_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--state color-{{ settings.badge_sold_out_color_scheme }}">
        {{ 'content.product_badge_sold_out' | t }}
      </div>
    {%- endcapture -%}
  {%- elsif product.compare_at_price > product.price -%}
    {%- capture state_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--state color-{{ settings.badge_sale_color_scheme }}">
        {{ 'content.product_badge_sale' | t }}
      </div>
    {%- endcapture -%}
  {%- elsif product.tags contains 'new' -%}
    {%- capture state_badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-new badge--state">New</div>
    {%- endcapture -%}
  {%- endif -%}

  {{ main_badge }}
  {{ state_badge }}
</div>


{% stylesheet %}
  .product-badges {
    --badge-inset: max(var(--padding-xs), calc((var(--border-radius) + var(--padding-xs)) * (1 - cos(45deg))));

    position: absolute;
    z-index: var(--layer-flat);
  }

  .product-badges--bottom-left {
    bottom: calc(var(--badge-inset) + var(--padding-block-start));
    left: calc(var(--badge-inset) + var(--padding-inline-start));
  }

  .product-badges--top-left {
    top: calc(var(--badge-inset) + var(--padding-block-start));
    left: calc(var(--badge-inset) + var(--padding-inline-start));
  }

  .product-badges--top-right {
    top: calc(var(--badge-inset) + var(--padding-block-start));
    right: calc(var(--badge-inset) + var(--padding-inline-start));
  }

  .product-badges__badge {
    --badge-font-size: var(--font-size--xs);

    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    color: var(--color-foreground);
    background: var(--color-background);
    font-size: var(--badge-font-size);
    font-family: var(--badge-font-family);
    font-weight: var(--badge-font-weight);
    text-transform: var(--badge-text-transform);
    border-radius: var(--badge-border-radius);
  }

  .product-badges__badge--rectangle {
    padding-block: var(--badge-rectangle-padding-block);
    padding-inline: var(--badge-rectangle-padding-inline);
  }

  /* --- Styles pour vos badges personnalisés (avec !important pour forcer si besoin) --- */
  .badge--custom-made {
    background-color: #b87200 !important;
    color: #7d4e24 !important;
  }
  .badge--custom-studio {
    background-color: #8f9090 !important;
    color: #000000 !important;
  }
  .badge--custom-creative {
    background-color: #1b72b9 !important;
    color: #fff !important;
  }
  .badge--custom-new {
    background-color: #28a745 !important;
    color: #fff !important;
  }

  .badge--custom-archive {
    background-color: #6c757d !important;
    color: #fff !important;
  }
  .badge--custom-soon {
    background-color: #7673BF !important;
    color: #000000 !important;
  }
  .badge--custom-preorder {
    background-color: #ffc107 !important;
    color: #000000 !important;
  }
  .product-badges {
  --badge-inset: max(var(--padding-xs), calc((var(--border-radius) + var(--padding-xs)) * (1 - cos(45deg))));

  position: absolute;
  z-index: var(--layer-flat);

  /* IMPORTANT: badges empilés */
  display: flex;
  flex-direction: column;
  gap: 6px;
  align-items: flex-start;
}

.product-badges__badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-align: center;

  color: var(--color-foreground);
  background: var(--color-background);

  font-size: var(--badge-font-size);
  font-family: var(--badge-font-family);
  font-weight: var(--badge-font-weight);
  text-transform: var(--badge-text-transform);

  border-radius: var(--badge-border-radius);
  white-space: nowrap;
}

.product-badges__badge--rectangle {
  padding-block: var(--badge-rectangle-padding-block);
  padding-inline: var(--badge-rectangle-padding-inline);
}

/* Badge état produit (en dessous) */
.badge--state {
  font-size: var(--badge-state-font-size);
  opacity: 0.9;
}

/* Mobile */
@media screen and (max-width: 749px) {
  .product-badges {
    gap: var(--badge-gap-mobile);
  }

  .product-badges__badge {
    font-size: var(--badge-font-size-mobile);
  }

  .badge--state {
    font-size: var(--badge-state-font-size-mobile);
  }
}

{% endstylesheet %}