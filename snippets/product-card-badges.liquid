{% comment %}
  Renders product badges for the product card.

  @param {object} product - The product object.
  @param {object} settings - The theme settings object.

  @example
  {% render 'product-card-badges', product: product, settings: settings %}
{% endcomment %}

<div
  class="product-badges product-badges--{{ settings.badge_position }}"
  style="
    --badge-border-radius: {{ settings.badge_corner_radius }}px;
    --badge-font-family: var(--font-{{ settings.badge_font_family }}--family);
    --badge-font-weight: var(--font-{{ settings.badge_font_family }}--weight);
    --badge-text-transform: {{ settings.badge_text_transform }};
  "
>
  {%- assign badges_html = '' -%}
  {%- assign badges_count = 0 -%}
  {%- assign badges_limit = 2 -%}

  {%- comment -%} 1) Badges basés sur tags (prioritaires) {%- endcomment -%}

  {%- if badges_count < badges_limit and product.tags contains 'soon' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-soon">Soon</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.tags contains 'archive' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-archive">Archivé</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.tags contains 'owl_studio' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-studio">Studio</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.tags contains 'owl_made' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-made">Made</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.tags contains 'owl_creative' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-creative">Creative</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.tags contains 'preorder' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-preorder">Précommande</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- comment -%} 2) Badges “état produit” (complètent si place dispo) {%- endcomment -%}

  {%- if badges_count < badges_limit and product.available == false -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle color-{{ settings.badge_sold_out_color_scheme }}">
        {{ 'content.product_badge_sold_out' | t }}
      </div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.compare_at_price > product.price -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle color-{{ settings.badge_sale_color_scheme }}">
        {{ 'content.product_badge_sale' | t }}
      </div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {%- if badges_count < badges_limit and product.tags contains 'new' -%}
    {%- capture badge -%}
      <div class="product-badges__badge product-badges__badge--rectangle badge--custom-new">New</div>
    {%- endcapture -%}
    {%- assign badges_html = badges_html | append: badge -%}
    {%- assign badges_count = badges_count | plus: 1 -%}
  {%- endif -%}

  {{ badges_html }}
</div>
